<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>è¡†é™¢é¸2026ï¼šæ—¥æœ¬åˆ¶è¦‡ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</title>
<style>
    :root { --main-bg: #020617; --card-bg: #0f172a; --accent: #facc15; --you: #22c55e; --ai: #ef4444; }
    body { margin: 0; font-family: "Hiragino Sans", "Meiryo", sans-serif; background: var(--main-bg); color: #f8fafc; overflow: hidden; }
    
    /* ç”»é¢åˆ‡ã‚Šæ›¿ãˆè¨­å®š */
    .screen { display: none; height: 100vh; padding: 20px; box-sizing: border-box; }
    .screen.active { display: block; }

    /* è¨­å®šç”»é¢ã®ãƒ‡ã‚¶ã‚¤ãƒ³ */
    .setup-container { max-width: 600px; margin: 40px auto; background: var(--card-bg); padding: 30px; border-radius: 20px; border: 2px solid #1e293b; }
    input[type="text"] { width: 100%; padding: 12px; font-size: 1.1rem; border-radius: 8px; border: none; margin: 15px 0; background: #1e293b; color: #fff; }
    .policy-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 20px 0; }
    .policy-item { background: #1e293b; padding: 10px; border-radius: 8px; cursor: pointer; }
    .start-btn { width: 100%; padding: 15px; background: var(--you); color: #fff; border: none; border-radius: 10px; font-size: 1.2rem; font-weight: bold; cursor: pointer; }

    /* ã‚²ãƒ¼ãƒ ç”»é¢ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
    .game-layout { display: flex; gap: 20px; height: 85vh; }
    .map-area { flex: 1; background: #000; position: relative; border-radius: 15px; border: 2px solid #1e293b; overflow: auto; }
    .map-body { position: relative; width: 1000px; height: 800px; }
    .side-panel { width: 350px; display: flex; flex-direction: column; gap: 15px; }

    /* éƒ½é“åºœçœŒãƒãƒƒãƒ— */
    .pref { 
        position: absolute; width: 80px; height: 50px; border-radius: 8px; 
        font-size: 0.75rem; display: flex; flex-direction: column; align-items: center; 
        justify-content: center; cursor: pointer; border: 1px solid rgba(255,255,255,0.2); 
        transition: transform 0.2s, box-shadow 0.2s;
    }
    .pref:hover { transform: scale(1.1); z-index: 100; }
    .pref.neutral { background: #334155; color: #94a3b8; }
    .pref.you { background: var(--you); color: #000; font-weight: bold; box-shadow: 0 0 15px var(--you); z-index: 10; border-color: #fff; }
    .pref.ai { background: var(--ai); color: #fff; font-weight: bold; box-shadow: 0 0 15px var(--ai); z-index: 10; border-color: #fff; }

    /* ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ */
    .action-btn { 
        width: 100%; padding: 12px; background: #334155; color: white; border: none; 
        border-radius: 8px; text-align: left; cursor: pointer; font-size: 0.9rem;
    }
    .action-btn:hover:not(:disabled) { background: #475569; border-left: 5px solid var(--accent); }
    .action-btn:disabled { opacity: 0.3; }

    /* ãƒ­ã‚°ã¨æƒ…å ± */
    .log-box { background: #000; border: 1px solid #1e293b; padding: 10px; height: 120px; overflow-y: auto; font-family: monospace; font-size: 0.85rem; color: #22c55e; }
    .seats-info { font-size: 1.2rem; font-weight: bold; text-align: center; background: #1e293b; padding: 10px; border-radius: 10px; }
    .turn-status { text-align: center; font-weight: bold; padding: 10px; border-radius: 8px; font-size: 1.1rem; }
</style>
</head>
<body>

<div id="setupScreen" class="screen active">
    <div class="setup-container">
        <h1 style="text-align:center; color:var(--accent);">è¡†é™¢é¸2026 å‡ºé¦¬ç™»éŒ²</h1>
        <p>ã‚ãªãŸã®æ”¿å…šåã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼š</p>
        <input type="text" id="partyNameInput" placeholder="ä¾‹ï¼šæœªæ¥æ—¥æœ¬å…š" value="ã‚ãªãŸå…š">
        
        <p>é‡ç‚¹å…¬ç´„ã‚’5ã¤é¸ã‚“ã§ãã ã•ã„ï¼ˆç¾åœ¨ã¯ç°¡æ˜“é¸æŠï¼‰ï¼š</p>
        <div class="policy-grid" id="policyGrid">
            <label class="policy-item"><input type="checkbox" value="çµŒæ¸ˆ"> çµŒæ¸ˆæˆé•·</label>
            <label class="policy-item"><input type="checkbox" value="ç¦ç¥‰"> ç¤¾ä¼šä¿éšœ</label>
            <label class="policy-item"><input type="checkbox" value="æ•™è‚²"> æ•™è‚²ç„¡å„ŸåŒ–</label>
            <label class="policy-item"><input type="checkbox" value="é˜²è¡›"> é˜²è¡›åŠ›å¼·åŒ–</label>
            <label class="policy-item"><input type="checkbox" value="ç’°å¢ƒ"> è„±ç‚­ç´ ç¤¾ä¼š</label>
            <label class="policy-item"><input type="checkbox" value="æ¸›ç¨"> æ¶ˆè²»ç¨æ¸›ç¨</label>
            <label class="policy-item"><input type="checkbox" value="æ”¹é©"> æ”¿æ²»æ”¹é©</label>
            <label class="policy-item"><input type="checkbox" value="åœ°æ–¹"> åœ°æ–¹å‰µç”Ÿ</label>
        </div>
        
        <button class="start-btn" onclick="startGame()">ã“ã®å†…å®¹ã§é¸æŒ™æˆ¦ã‚’é–‹å§‹ï¼</button>
    </div>
</div>

<div id="gameScreen" class="screen">
    <div style="display:flex; justify-content:space-between; margin-bottom:15px;">
        <h2 id="displayPartyName"></h2>
        <div id="turnDisplay" style="font-size:1.2rem; color:var(--accent);"></div>
    </div>

    <div class="game-layout">
        <div class="map-area">
            <div id="mapBody" class="map-body"></div>
        </div>

        <div class="side-panel">
            <div id="turnIndicator" class="turn-status" style="background:var(--accent); color:#000;">ã‚ãªãŸã®ç•ª</div>
            
            <div id="controls">
                <button class="action-btn" onclick="setActionMode('speech')">ğŸ¤ è¡—é ­æ¼”èª¬ (åœ°å›³ã‹ã‚‰çœŒã‚’é¸æŠ)</button>
                <button class="action-btn" onclick="quickAction('sns')">ğŸ“± SNSæˆ¦ç•¥ (éƒ½å¸‚éƒ¨ã‚’1çœŒå¥ªå–)</button>
                <button class="action-btn" onclick="quickAction('home')">ğŸ  æˆ¸åˆ¥è¨ªå• (åœ°æ–¹ã‚’1çœŒå¥ªå–)</button>
                <button class="action-btn" onclick="quickAction('tv')">ğŸ“º ãƒ†ãƒ¬ãƒ“å‡ºæ¼” (ä¸­ç«‹ã‚’1çœŒå¥ªå–)</button>
                <button class="action-btn" onclick="quickAction('flyer')">ğŸ“„ ãƒ“ãƒ©é…å¸ƒ (å…¨å›½ã¸ãƒ©ãƒ³ãƒ€ãƒ )</button>
            </div>

            <div class="log-box" id="newsLog">
                <div>> é¸æŒ™æˆ¦ã®ç«è“‹ãŒåˆ‡ã‚‰ã‚Œã¾ã—ãŸã€‚</div>
            </div>

            <div class="seats-info">
                <div id="seatStats"></div>
                <div style="font-size:0.7rem; color:#94a3b8; margin-top:5px;">éåŠæ•°: 233 / å…¨465è­°å¸­</div>
            </div>
        </div>
    </div>
</div>

<script>
// 47éƒ½é“åºœçœŒã®åº§æ¨™ã¨è­°å¸­ãƒ‡ãƒ¼ã‚¿
const JAPAN_DATA = {
    "åŒ—æµ·é“": {x:760, y:20, s:17, t:"r"}, "é’æ£®": {x:760, y:120, s:6, t:"r"}, "å²©æ‰‹": {x:850, y:160, s:6, t:"r"},
    "ç§‹ç”°": {x:670, y:160, s:5, t:"r"}, "å±±å½¢": {x:690, y:240, s:6, t:"r"}, "å®®åŸ": {x:830, y:240, s:10, t:"r"},
    "ç¦å³¶": {x:760, y:310, s:9, t:"r"}, "æ–°æ½Ÿ": {x:580, y:210, s:10, t:"r"}, "å¯Œå±±": {x:490, y:210, s:6, t:"r"},
    "çŸ³å·": {x:400, y:210, s:6, t:"r"}, "ç¦äº•": {x:340, y:270, s:4, t:"r"}, "é•·é‡": {x:510, y:310, s:10, t:"r"},
    "å²é˜œ": {x:410, y:370, s:10, t:"r"}, "å±±æ¢¨": {x:500, y:420, s:4, t:"r"}, "æ„›çŸ¥": {x:400, y:470, s:15, t:"u"},
    "é™å²¡": {x:480, y:530, s:16, t:"u"}, "æ»‹è³€": {x:330, y:350, s:4, t:"r"}, "ä¸‰é‡": {x:350, y:580, s:8, t:"r"},
    "å¥ˆè‰¯": {x:290, y:510, s:6, t:"r"}, "å’Œæ­Œå±±": {x:240, y:630, s:5, t:"r"}, "å¤§é˜ª": {x:200, y:460, s:19, t:"u"},
    "äº¬éƒ½": {x:270, y:370, s:12, t:"u"}, "å…µåº«": {x:180, y:360, s:12, t:"u"}, "é³¥å–": {x:110, y:290, s:4, t:"r"},
    "å³¶æ ¹": {x:20, y:290, s:4, t:"r"}, "å²¡å±±": {x:110, y:370, s:10, t:"r"}, "åºƒå³¶": {x:20, y:370, s:12, t:"r"},
    "å±±å£": {x:20, y:470, s:8, t:"r"}, "é¦™å·": {x:90, y:540, s:6, t:"r"}, "å¾³å³¶": {x:160, y:580, s:6, t:"r"},
    "æ„›åª›": {x:20, y:580, s:8, t:"r"}, "é«˜çŸ¥": {x:90, y:640, s:4, t:"r"}, "ç¦å²¡": {x:110, y:150, s:11, t:"u"},
    "ä½è³€": {x:20, y:140, s:4, t:"r"}, "é•·å´": {x:20, y:210, s:8, t:"r"}, "å¤§åˆ†": {x:200, y:210, s:6, t:"r"},
    "ç†Šæœ¬": {x:110, y:250, s:8, t:"r"}, "å®®å´": {x:200, y:120, s:6, t:"r"}, "é¹¿å…å³¶": {x:110, y:50, s:9, t:"r"},
    "æ²–ç¸„": {x:20, y:40, s:4, t:"r"}, "æ ƒæœ¨": {x:690, y:380, s:10, t:"r"}, "ç¾¤é¦¬": {x:610, y:330, s:10, t:"r"},
    "èŒ¨åŸ": {x:790, y:420, s:13, t:"r"}, "åŸ¼ç‰": {x:610, y:440, s:28, t:"u"}, "åƒè‘‰": {x:800, y:530, s:22, t:"u"},
    "æ±äº¬": {x:690, y:520, s:30, t:"u"}, "ç¥å¥ˆå·": {x:580, y:570, s:26, t:"u"}
};

let status = {}, turns = 45, day = 1, isPlayer = true, currentMode = null, partyName = "";

function startGame() {
    const checks = document.querySelectorAll('input[type="checkbox"]:checked');
    if (checks.length !== 5) { alert("å…¬ç´„ã‚’5ã¤é¸ã‚“ã§ãã ã•ã„ï¼"); return; }
    
    partyName = document.getElementById("partyNameInput").value || "ã‚ãªãŸå…š";
    document.getElementById("setupScreen").classList.remove("active");
    document.getElementById("gameScreen").classList.add("active");
    document.getElementById("displayPartyName").textContent = partyName + " é¸æŒ™æœ¬éƒ¨";
    
    initMap();
    updateUI();
}

function initMap() {
    const map = document.getElementById("mapBody");
    Object.keys(JAPAN_DATA).forEach(name => {
        status[name] = "neutral";
        const d = document.createElement("div");
        d.className = "pref neutral";
        d.id = `pref-${name}`;
        d.style.left = JAPAN_DATA[name].x + "px";
        d.style.top = JAPAN_DATA[name].y + "px";
        d.innerHTML = `<span>${name}</span><span style="font-size:0.6rem;">(${JAPAN_DATA[name].s})</span>`;
        d.onclick = () => onPrefClick(name);
        map.appendChild(d);
    });
}

function setActionMode(mode) {
    if(!isPlayer) return;
    currentMode = mode;
    log("åœ°å›³ã‹ã‚‰æ¼”èª¬ã™ã‚‹çœŒã‚’é¸ã‚“ã§ãã ã•ã„ã€‚");
}

function onPrefClick(name) {
    if(!isPlayer || currentMode !== 'speech') return;
    status[name] = "you";
    log(`${name}ã§æ¼”èª¬ï¼æ”¯æŒã‚’å›ºã‚ã¾ã—ãŸã€‚`);
    endTurn();
}

function quickAction(type) {
    if(!isPlayer) return;
    let target = "";
    if(type === 'sns') {
        const list = Object.keys(status).filter(p => JAPAN_DATA[p].t === 'u' && status[p] !== 'you');
        target = list[Math.floor(Math.random() * list.length)];
        log(`SNSã§${target}ã®ãƒˆãƒ¬ãƒ³ãƒ‰ã«å…¥ã‚Šã¾ã—ãŸï¼`);
    } else if(type === 'home') {
        const list = Object.keys(status).filter(p => JAPAN_DATA[p].t === 'r' && status[p] !== 'you');
        target = list[Math.floor(Math.random() * list.length)];
        log(`åœ°é“ãªè¨ªå•ã§${target}ã®ä¿¡é ¼ã‚’å¾—ã¾ã—ãŸã€‚`);
    } else {
        const list = Object.keys(status).filter(p => status[p] === 'neutral');
        target = list[Math.floor(Math.random() * list.length)] || Object.keys(status)[0];
        log(`${target}ã¸æ”¿ç­–ã‚’ã‚¢ãƒ”ãƒ¼ãƒ«ã—ã¾ã—ãŸã€‚`);
    }
    if(target) status[target] = "you";
    endTurn();
}

function endTurn() {
    currentMode = null;
    isPlayer = false;
    turns--;
    updateUI();
    document.getElementById("turnIndicator").textContent = "ç›¸æ‰‹ãŒæ€è€ƒä¸­...";
    document.getElementById("turnIndicator").style.background = "#ef4444";
    document.getElementById("turnIndicator").style.color = "#fff";
    setTimeout(aiAction, 800);
}

function aiAction() {
    const targets = Object.keys(status).filter(p => status[p] !== 'ai');
    if(targets.length) {
        const p = targets[Math.floor(Math.random() * targets.length)];
        status[p] = "ai";
        log(`ã€è­¦å‘Šã€‘ç›¸æ‰‹å€™è£œãŒ${p}ã§é›†ä¼šã‚’é–‹ãã¾ã—ãŸï¼`);
    }
    if(Math.random() < 0.1) scandal();
    if(turns % 3 === 0) day++;
    isPlayer = true;
    document.getElementById("turnIndicator").textContent = "ã‚ãªãŸã®ç•ª";
    document.getElementById("turnIndicator").style.background = "#facc15";
    document.getElementById("turnIndicator").style.color = "#000";
    updateUI();
}

function scandal() {
    const myPrefs = Object.keys(status).filter(p => status[p] === 'you');
    if(myPrefs.length) {
        const p = myPrefs[Math.floor(Math.random() * myPrefs.length)];
        status[p] = "ai";
        log(`ã€ä¸ç¥¥äº‹ã€‘${partyName}ã«ã‚¹ã‚­ãƒ£ãƒ³ãƒ€ãƒ«ï¼${p}ã®æ”¯æŒãŒæ€¥è½ã€‚`, true);
    }
}

function updateUI() {
    let you = 0, ai = 0;
    Object.keys(status).forEach(name => {
        const d = document.getElementById(`pref-${name}`);
        d.className = `pref ${status[name]}`;
        if(status[name] === "you") you += JAPAN_DATA[name].s;
        if(status[name] === "ai") ai += JAPAN_DATA[name].s;
    });
    document.getElementById("seatStats").innerHTML = 
        `<span style="color:var(--you)">${partyName}: ${you}</span><br>` +
        `<span style="color:var(--ai)">ç›¸æ‰‹æ”¿å…š: ${ai}</span>`;
    document.getElementById("turnDisplay").textContent = `${day}æ—¥ç›® (æ®‹ã‚Š${turns}å›)`;
    if(turns <= 0) {
        alert(`æŠ•é–‹ç¥¨çµ‚äº†ï¼\nç²å¾—è­°å¸­ï¼š${you}\n${you >= 233 ? "éåŠæ•°é”æˆï¼ç·ç†å¤§è‡£ã«æŒ‡åã•ã‚Œã¾ã—ãŸï¼" : "æ®‹å¿µãªãŒã‚‰æ•—åŒ—ã—ã¾ã—ãŸã€‚"}`);
        location.reload();
    }
}

function log(m, breaking = false) {
    const l = document.getElementById("newsLog");
    const d = document.createElement("div");
    if(breaking) d.style.color = "#ff4444";
    d.textContent = (breaking ? "ã€é€Ÿå ±ã€‘" : "> ") + m;
    l.prepend(d);
}
</script>
</body>
</html>
