<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>è¡†é™¢é¸2026 å®Œå…¨åˆ¶åº¦ç‰ˆ</title>
<style>
:root{
--bg:#020617;--card:#1e293b;
--p1:#22c55e;--p2:#3b82f6;
}
body{margin:0;font-family:sans-serif;background:var(--bg);color:#fff}
.screen{display:none;padding:20px}
.screen.active{display:block}
.card{background:var(--card);padding:15px;border-radius:12px;margin-bottom:15px}
button{padding:10px;border-radius:8px;border:none;cursor:pointer;font-weight:bold}
button.act{width:100%;margin:4px 0;background:#334155;color:#fff}
button.act:hover{background:#475569}

.meter{
position:relative;height:40px;background:#111827;
border-radius:20px;overflow:hidden;border:2px solid #fff;
margin-bottom:10px;display:flex
}
.bar-left{background:var(--p1);height:100%;display:flex;align-items:center;padding-left:10px;font-weight:bold}
.bar-right{background:var(--p2);height:100%;margin-left:auto;display:flex;align-items:center;justify-content:flex-end;padding-right:10px;font-weight:bold}
.majority-line{
position:absolute;
left:50%;
transform:translateX(-50%);
width:3px;height:100%;
background:#facc15;
}

.game{display:grid;grid-template-columns:1fr 300px;gap:15px}

#map{
display:grid;
grid-template-columns:repeat(auto-fill,minmax(90px,1fr));
gap:6px;
}
.pref{
padding:8px;border-radius:6px;font-size:.75rem;text-align:center;
background:#374151;cursor:pointer
}
.pref.p1{background:var(--p1);color:#000;font-weight:bold}
.pref.p2{background:var(--p2);font-weight:bold}
.small{font-size:.8rem;color:#cbd5e1}
</style>
</head>
<body>

<div id="setup" class="screen active">
<div class="card">
<h2>ãƒ¢ãƒ¼ãƒ‰é¸æŠ</h2>
<label><input type="radio" name="mode" value="solo" checked> 1äººãƒ—ãƒ¬ã‚¤</label><br>
<label><input type="radio" name="mode" value="vs"> 2äººãƒ—ãƒ¬ã‚¤</label>
</div>
<div class="card">
<input id="p1name" placeholder="ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼1æ”¿å…šå">
<input id="p2name" placeholder="ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼2æ”¿å…šå">
</div>
<button onclick="start()">é–‹å§‹</button>
</div>

<div id="game" class="screen">
<div id="turnInfo" style="font-weight:bold;margin-bottom:10px"></div>

<div class="meter">
<div id="bar1" class="bar-left"></div>
<div id="bar2" class="bar-right"></div>
<div class="majority-line"></div>
</div>

<div id="seatDetail" class="small"></div>

<div class="game">
<div id="map"></div>
<div>
<button class="act" onclick="speechMode()">ğŸ¤ åœ°æ–¹æ¼”èª¬ï¼ˆ+6ï¼‰</button>
<button class="act" onclick="action('sns')">ğŸ“± SNSï¼ˆ40%ã«+2ï¼‰</button>
<button class="act" onclick="action('tv')">ğŸ“º TVè¨è«–ï¼ˆæ¥æˆ¦åŒº+4ï¼‰</button>
<button class="act" onclick="action('scandal')">ğŸ”¥ ãƒã‚¬ã‚­ãƒ£ãƒ³ï¼ˆ30%ç›¸æ‰‹-3ï¼‰</button>
</div>
</div>
</div>

<div id="result" class="screen">
<h2>ğŸ“º é–‹ç¥¨é€Ÿå ±</h2>
<div class="meter">
<div id="rbar1" class="bar-left"></div>
<div id="rbar2" class="bar-right"></div>
</div>
<div id="winner" style="font-size:24px;margin-top:20px"></div>
<button onclick="location.reload()">ã‚‚ã†ä¸€åº¦</button>
</div>

<script>
const TOTAL=465;
const MAJ=233;
const DAYS=15;
const PHASES=["æœ","æ˜¼","å¤œ"];

const SEATS={/* å°é¸æŒ™åŒº289å›ºå®š */
"åŒ—æµ·é“":12,"é’æ£®":3,"å²©æ‰‹":3,"å®®åŸ":6,"ç§‹ç”°":3,"å±±å½¢":3,"ç¦å³¶":5,
"èŒ¨åŸ":7,"æ ƒæœ¨":4,"ç¾¤é¦¬":4,"åŸ¼ç‰":15,"åƒè‘‰":13,"æ±äº¬":30,"ç¥å¥ˆå·":18,
"æ–°æ½Ÿ":6,"å¯Œå±±":3,"çŸ³å·":3,"ç¦äº•":2,"å±±æ¢¨":2,"é•·é‡":5,"å²é˜œ":5,"é™å²¡":8,"æ„›çŸ¥":15,
"ä¸‰é‡":4,"æ»‹è³€":4,"äº¬éƒ½":6,"å¤§é˜ª":19,"å…µåº«":12,"å¥ˆè‰¯":3,"å’Œæ­Œå±±":2,
"é³¥å–":2,"å³¶æ ¹":2,"å²¡å±±":5,"åºƒå³¶":7,"å±±å£":4,"å¾³å³¶":2,"é¦™å·":3,"æ„›åª›":4,"é«˜çŸ¥":2,
"ç¦å²¡":11,"ä½è³€":2,"é•·å´":4,"ç†Šæœ¬":4,"å¤§åˆ†":3,"å®®å´":3,"é¹¿å…å³¶":4,"æ²–ç¸„":4
};

const BLOCKS={/* æ¯”ä¾‹176å›ºå®š */
"åŒ—æµ·é“":{seats:8,prefs:["åŒ—æµ·é“"]},
"æ±åŒ—":{seats:14,prefs:["é’æ£®","å²©æ‰‹","å®®åŸ","ç§‹ç”°","å±±å½¢","ç¦å³¶"]},
"åŒ—é–¢æ±":{seats:19,prefs:["èŒ¨åŸ","æ ƒæœ¨","ç¾¤é¦¬"]},
"å—é–¢æ±":{seats:22,prefs:["åŸ¼ç‰","åƒè‘‰","ç¥å¥ˆå·"]},
"æ±äº¬":{seats:17,prefs:["æ±äº¬"]},
"åŒ—é™¸ä¿¡è¶Š":{seats:11,prefs:["æ–°æ½Ÿ","å¯Œå±±","çŸ³å·","ç¦äº•","é•·é‡"]},
"æ±æµ·":{seats:21,prefs:["å²é˜œ","é™å²¡","æ„›çŸ¥","ä¸‰é‡"]},
"è¿‘ç•¿":{seats:28,prefs:["æ»‹è³€","äº¬éƒ½","å¤§é˜ª","å…µåº«","å¥ˆè‰¯","å’Œæ­Œå±±"]},
"ä¸­å›½":{seats:11,prefs:["é³¥å–","å³¶æ ¹","å²¡å±±","åºƒå³¶","å±±å£"]},
"å››å›½":{seats:6,prefs:["å¾³å³¶","é¦™å·","æ„›åª›","é«˜çŸ¥"]},
"ä¹å·":{seats:18,prefs:["ç¦å²¡","ä½è³€","é•·å´","ç†Šæœ¬","å¤§åˆ†","å®®å´","é¹¿å…å³¶","æ²–ç¸„"]}
};

const PREFS=Object.keys(SEATS);

let data={},mode,current=1,turn=1,p1,p2,speech=false;

function start(){
mode=document.querySelector("input[name=mode]:checked").value;
p1=document.getElementById("p1name").value||"ç·‘å…š";
p2=mode==="solo"?"AIå…š":(document.getElementById("p2name").value||"é’å…š");

document.getElementById("setup").classList.remove("active");
document.getElementById("game").classList.add("active");

const map=document.getElementById("map");
PREFS.forEach(p=>{
data[p]={p1:50,p2:50};
const d=document.createElement("div");
d.className="pref";
d.textContent=p+"("+SEATS[p]+")";
d.onclick=()=>prefClick(p);
map.appendChild(d);
});
update();
}

function speechMode(){speech=true;}

function prefClick(p){
if(!speech)return;
data[p]["p"+current]+=6;
clamp(p);
speech=false;
next();
}

function action(type){
if(type==="sns"){
PREFS.forEach(p=>{
if(Math.random()<0.4){
data[p]["p"+current]+=2;
clamp(p);
}
});
}
if(type==="tv"){
PREFS.forEach(p=>{
if(Math.abs(data[p].p1-data[p].p2)<5){
data[p]["p"+current]+=4;
clamp(p);
}
});
}
if(type==="scandal"){
PREFS.forEach(p=>{
if(Math.random()<0.3){
data[p]["p"+(current===1?2:1)]-=3;
clamp(p);
}
});
}
next();
}

function clamp(p){
data[p].p1=Math.max(0,Math.min(100,data[p].p1));
data[p].p2=Math.max(0,Math.min(100,data[p].p2));
}

function next(){
if(mode==="solo"&&current===1){aiTurn();}
current=current===1?2:1;
turn++;
update();
if(turn>DAYS*3) finish();
}

function aiTurn(){
let r=PREFS[Math.floor(Math.random()*PREFS.length)];
data[r].p2+=6;
clamp(r);
}

function dhondt(v1,v2,seats){
let q=[];
for(let i=1;i<=seats;i++){
q.push({p:1,v:v1/i});
q.push({p:2,v:v2/i});
}
q.sort((a,b)=>b.v-a.v);
let p1=0,p2=0;
for(let i=0;i<seats;i++){
if(q[i].p===1)p1++;else p2++;
}
return{p1,p2};
}

function calculate(){
let smd1=0,smd2=0;
PREFS.forEach(p=>{
if(data[p].p1>data[p].p2)smd1+=SEATS[p];
else smd2+=SEATS[p];
});

let pr1=0,pr2=0;
for(const b in BLOCKS){
let v1=0,v2=0;
BLOCKS[b].prefs.forEach(p=>{
v1+=data[p].p1;
v2+=data[p].p2;
});
let r=dhondt(v1,v2,BLOCKS[b].seats);
pr1+=r.p1;
pr2+=r.p2;
}

return{
smd1,smd2,pr1,pr2,
total1:smd1+pr1,
total2:smd2+pr2
};
}

function update(){
const c=calculate();
let day=Math.ceil(turn/3);
let phase=PHASES[(turn-1)%3];
document.getElementById("turnInfo").textContent=
day+"æ—¥ç›®ã€"+phase+"ã€‘ï½œç¾åœ¨ï¼š"+(current===1?p1:p2);

document.querySelectorAll(".pref").forEach(e=>{
let p=e.textContent.split("(")[0];
if(data[p].p1===50&&data[p].p2===50)e.className="pref";
else e.className="pref "+(data[p].p1>data[p].p2?"p1":"p2");
});

document.getElementById("bar1").style.width=(c.total1/TOTAL*100)+"%";
document.getElementById("bar2").style.width=(c.total2/TOTAL*100)+"%";
document.getElementById("bar1").textContent=p1+" "+c.total1;
document.getElementById("bar2").textContent=c.total2+" "+p2;

document.getElementById("seatDetail").textContent=
"å°é¸æŒ™åŒºï¼š"+c.smd1+" / "+c.smd2+
" ï½œ æ¯”ä¾‹ï¼š"+c.pr1+" / "+c.pr2+
" ï½œ åˆè¨ˆï¼š"+c.total1+" / "+c.total2+
" ï½œ éåŠæ•°ï¼š"+MAJ;
}

function finish(){
document.getElementById("game").classList.remove("active");
document.getElementById("result").classList.add("active");

const c=calculate();
document.getElementById("rbar1").style.width=(c.total1/TOTAL*100)+"%";
document.getElementById("rbar2").style.width=(c.total2/TOTAL*100)+"%";
document.getElementById("rbar1").textContent=p1+" "+c.total1;
document.getElementById("rbar2").textContent=c.total2+" "+p2;

document.getElementById("winner").textContent=
c.total1>c.total2?p1+" å‹åˆ©ï¼":p2+" å‹åˆ©ï¼";
}
</script>
</body>
</html>
