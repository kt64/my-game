<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¡†é™¢é¸2026ï¼š2äººå¯¾æˆ¦ãƒ»æ¯”ä¾‹ä»£è¡¨ç‰ˆ</title>
    <style>
        :root { --bg: #020617; --card: #1e293b; --acc: #facc15; --p1: #22c55e; --p2: #3b82f6; --neutral: #334155; }
        body { margin: 0; font-family: "Hiragino Sans", sans-serif; background: var(--bg); color: #f8fafc; overflow: hidden; }
        .screen { display: none; height: 100vh; padding: 20px; box-sizing: border-box; }
        .screen.active { display: block; }
        
        /* ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— */
        .setup-box { max-width: 600px; margin: 20px auto; background: var(--card); padding: 25px; border-radius: 20px; text-align: center; border: 2px solid #334155; }
        .input-group { display: flex; gap: 10px; margin: 10px 0; }
        input { flex: 1; padding: 10px; border-radius: 8px; border: none; background: #0f172a; color: white; }

        /* è­°å¸­ãƒ¡ãƒ¼ã‚¿ãƒ¼ */
        .meter-container { width: 100%; height: 30px; background: #334155; border-radius: 15px; margin: 10px 0; position: relative; overflow: hidden; display: flex; }
        .meter-p1 { height: 100%; background: var(--p1); transition: 0.5s; }
        .meter-p2 { height: 100%; background: var(--p2); transition: 0.5s; }
        .meter-line { position: absolute; left: 50%; top: 0; width: 2px; height: 100%; background: white; z-index: 10; }
        .meter-label { position: absolute; width: 100%; text-align: center; font-size: 0.8rem; font-weight: bold; line-height: 30px; pointer-events: none; }

        /* ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
        .game-layout { display: flex; gap: 15px; height: 75vh; }
        .map-area { flex: 1; background: #000; position: relative; border-radius: 15px; border: 1px solid #334155; overflow: auto; padding: 20px; }
        .map-grid { display: grid; grid-template-columns: repeat(8, 1fr); gap: 10px; }
        
        /* éƒ½é“åºœçœŒãƒ‘ãƒãƒ« */
        .pref { padding: 10px; border-radius: 8px; text-align: center; font-size: 0.8rem; cursor: pointer; border: 1px solid rgba(255,255,255,0.1); transition: 0.2s; }
        .region-tag { grid-column: 1 / -1; background: #1e293b; color: var(--acc); font-size: 0.7rem; padding: 2px 10px; border-radius: 4px; margin-top: 10px; }
        .pref.neutral { background: var(--neutral); color: #94a3b8; }
        .pref.p1 { background: var(--p1); color: #000; font-weight: bold; box-shadow: 0 0 10px var(--p1); }
        .pref.p2 { background: var(--p2); color: #fff; font-weight: bold; box-shadow: 0 0 10px var(--p2); }

        /* ã‚µã‚¤ãƒ‰ãƒ‘ãƒãƒ« */
        .side { width: 300px; display: flex; flex-direction: column; gap: 8px; }
        .action-btn { width: 100%; padding: 12px; background: #334155; color: white; border: none; border-radius: 8px; cursor: pointer; text-align: left; font-size: 0.85rem; }
        .action-btn:hover { background: #475569; border-left: 4px solid var(--acc); }
        .log { background: #000; border: 1px solid #334155; padding: 10px; height: 120px; overflow-y: auto; font-family: monospace; font-size: 0.75rem; color: #4ade80; }
        .turn-info { padding: 10px; text-align: center; font-weight: bold; border-radius: 8px; transition: 0.3s; }
    </style>
</head>
<body>

<div id="setup" class="screen active">
    <div class="setup-box">
        <h1 style="color:var(--acc)">è¡†é™¢é¸2026ï¼šæ±ºæˆ¦</h1>
        <div class="input-group">
            <span style="color:var(--p1); font-weight:bold;">1P:</span>
            <input type="text" id="p1Name" value="ä¸å…šé€£åˆ">
        </div>
        <div class="input-group">
            <span style="color:var(--p2); font-weight:bold;">2P:</span>
            <input type="text" id="p2Name" value="é‡å…šå…±é—˜">
        </div>
        <p style="font-size:0.8rem;">â€»2äººå¯¾æˆ¦ã¯1å°ã®ç«¯æœ«ã§äº¤äº’ã«æ“ä½œã—ã¾ã™</p>
        <button class="btn-start" onclick="initGame()" style="width:100%; padding:15px; background:var(--p1); color:white; border:none; border-radius:10px; font-weight:bold; cursor:pointer;">é¸æŒ™æˆ¦ã‚¹ã‚¿ãƒ¼ãƒˆï¼</button>
    </div>
</div>

<div id="main" class="screen">
    <div class="meter-container">
        <div id="m1" class="meter-p1" style="width: 0%"></div>
        <div id="m2" class="meter-p2" style="width: 0%"></div>
        <div class="meter-line"></div>
        <div class="meter-label">éåŠæ•° 233è­°å¸­</div>
    </div>

    <div style="display:flex; justify-content:space-between; align-items:flex-end; margin-bottom:5px;">
        <h3 id="p1Stats" style="color:var(--p1); margin:0;"></h3>
        <div id="dispDay" style="color:var(--acc); font-weight:bold;">1æ—¥ç›® / æ®‹ã‚Š30æ‰‹</div>
        <h3 id="p2Stats" style="color:var(--p2); margin:0;"></h3>
    </div>

    <div class="game-layout">
        <div class="map-area">
            <div id="map" class="map-grid"></div>
        </div>
        
        <div class="side">
            <div id="turnBox" class="turn-info">1Pã®ç•ªã§ã™</div>
            <button class="action-btn" onclick="action('speech')">ğŸ¤ è¡—é ­æ¼”èª¬ (ä¸­ç«‹ã‚’1ã¤ç²å¾—)</button>
            <button class="action-btn" onclick="action('sns')">ğŸ“± SNSãƒã‚º (éƒ½å¸‚éƒ¨ã‹ã‚‰1ã¤å¥ªå–)</button>
            <button class="action-btn" onclick="action('tv')">ğŸ“º å…¨å›½ä¸­ç¶™ (æ¯”ä¾‹ç¥¨+10)</button>
            <button class="action-btn" onclick="action('home')">ğŸ  é‡ç‚¹è£œå¼· (è‡ªåˆ†ã®çœŒã‚’ã‚¬ãƒ¼ãƒ‰)</button>
            <button class="action-btn" onclick="action('scandal')">ğŸ”¥ ç›¸æ‰‹ã®ã‚¹ã‚­ãƒ£ãƒ³ãƒ€ãƒ« (ç›¸æ‰‹ã®çœŒã‚’1ã¤ä¸­ç«‹ã«)</button>
            <button class="action-btn" onclick="action('last')">ğŸ“¢ ç·æ±ºèµ·é›†ä¼š (æ¯”ä¾‹ç¥¨+5 & ä¸­ç«‹1ç²å¾—)</button>
            
            <div id="log" class="log"><div>> æŠ•é–‹ç¥¨ã¾ã§æ®‹ã‚Š30ã‚¿ãƒ¼ãƒ³ã€‚</div></div>
            <div style="background:var(--card); padding:10px; border-radius:8px; font-size:0.8rem;">
                <b>æ¯”ä¾‹ä»£è¡¨(å¾—ç¥¨æ•°):</b><br>
                <span id="p1Prop" style="color:var(--p1)"></span> | <span id="p2Prop" style="color:var(--p2)"></span>
            </div>
        </div>
    </div>
</div>

<script>
const PREFS = {
    "åŒ—æµ·é“ãƒ»æ±åŒ—": ["åŒ—æµ·é“", "é’æ£®", "å²©æ‰‹", "å®®åŸ", "ç§‹ç”°", "å±±å½¢", "ç¦å³¶"],
    "åŒ—é–¢æ±ãƒ»ç”²ä¿¡è¶Š": ["èŒ¨åŸ", "æ ƒæœ¨", "ç¾¤é¦¬", "åŸ¼ç‰", "æ–°æ½Ÿ", "å±±æ¢¨", "é•·é‡"],
    "å—é–¢æ±": ["åƒè‘‰", "æ±äº¬", "ç¥å¥ˆå·"],
    "åŒ—é™¸ãƒ»æ±æµ·": ["å¯Œå±±", "çŸ³å·", "ç¦äº•", "å²é˜œ", "é™å²¡", "æ„›çŸ¥", "ä¸‰é‡"],
    "è¿‘ç•¿": ["æ»‹è³€", "äº¬éƒ½", "å¤§é˜ª", "å…µåº«", "å¥ˆè‰¯", "å’Œæ­Œå±±"],
    "ä¸­å›½ãƒ»å››å›½": ["é³¥å–", "å³¶æ ¹", "å²¡å±±", "åºƒå³¶", "å±±å£", "å¾³å³¶", "é¦™å·", "æ„›åª›", "é«˜çŸ¥"],
    "ä¹å·ãƒ»æ²–ç¸„": ["ç¦å²¡", "ä½è³€", "é•·å´", "ç†Šæœ¬", "å¤§åˆ†", "å®®å´", "é¹¿å…å³¶", "æ²–ç¸„"]
};
const SEATS = { "åŒ—æµ·é“":17,"é’æ£®":6,"å²©æ‰‹":6,"å®®åŸ":10,"ç§‹ç”°":5,"å±±å½¢":6,"ç¦å³¶":9,"èŒ¨åŸ":13,"æ ƒæœ¨":10,"ç¾¤é¦¬":10,"åŸ¼ç‰":28,"åƒè‘‰":22,"æ±äº¬":30,"ç¥å¥ˆå·":26,"æ–°æ½Ÿ":10,"å¯Œå±±":6,"çŸ³å·":6,"ç¦äº•":4,"å±±æ¢¨":4,"é•·é‡":10,"å²é˜œ":10,"é™å²¡":16,"æ„›çŸ¥":15,"ä¸‰é‡":8,"æ»‹è³€":4,"äº¬éƒ½":12,"å¤§é˜ª":19,"å…µåº«":12,"å¥ˆè‰¯":6,"å’Œæ­Œå±±":5,"é³¥å–":4,"å³¶æ ¹":4,"å²¡å±±":10,"åºƒå³¶":12,"å±±å£":8,"å¾³å³¶":6,"é¦™å·":6,"æ„›åª›":8,"é«˜çŸ¥":4,"ç¦å²¡":11,"ä½è³€":4,"é•·å´":8,"å¤§åˆ†":6,"å®®å´":6,"é¹¿å…å³¶":9,"æ²–ç¸„":4 };
const CITIES = ["æ±äº¬", "å¤§é˜ª", "ç¥å¥ˆå·", "æ„›çŸ¥", "åŸ¼ç‰", "åƒè‘‰", "ç¦å²¡", "äº¬éƒ½", "å…µåº«"];

let status = {}, turns = 30, day = 1, currentPlayer = 1;
let p1Name, p2Name, p1Hirei = 0, p2Hirei = 0;

function initGame() {
    p1Name = document.getElementById("p1Name").value;
    p2Name = document.getElementById("p2Name").value;
    document.getElementById("setup").classList.remove("active");
    document.getElementById("main").classList.add("active");
    
    const map = document.getElementById("map");
    for (const [region, prefs] of Object.entries(PREFS)) {
        const tag = document.createElement("div");
        tag.className = "region-tag"; tag.textContent = region;
        map.appendChild(tag);
        prefs.forEach(name => {
            status[name] = 0;
            const d = document.createElement("div");
            d.className = "pref neutral"; d.id = name;
            d.innerHTML = `${name}<br><b>${SEATS[name]}</b>`;
            d.onclick = () => { /* ã‚¯ãƒªãƒƒã‚¯æ“ä½œã¯ä»Šå›ãƒœã‚¿ãƒ³å¼ã«çµ±åˆ */ };
            map.appendChild(d);
        });
    }
    updateUI();
}

function action(type) {
    const opp = currentPlayer === 1 ? 2 : 1;
    let msg = "";

    if (type === 'speech') {
        const list = Object.keys(status).filter(p => status[p] === 0);
        if(list.length) {
            const p = list[Math.floor(Math.random()*list.length)];
            status[p] = currentPlayer;
            msg = `${p}ã§è¡—é ­æ¼”èª¬ã—ã€æ”¯æŒã‚’å›ºã‚ã¾ã—ãŸã€‚`;
        }
    } else if (type === 'sns') {
        const list = CITIES.filter(p => status[p] === opp);
        if(list.length) {
            const p = list[Math.floor(Math.random()*list.length)];
            status[p] = currentPlayer;
            msg = `SNSã§æ‹¡æ•£ï¼ç›¸æ‰‹ã®åœ°ç›¤ã ã£ãŸ${p}ã‚’å¥ªå–ã—ã¾ã—ãŸï¼`;
        } else { msg = "SNSã§ç™ºä¿¡ã—ã¾ã—ãŸãŒã€ç‰¹ã«å¤‰åŒ–ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚"; }
    } else if (type === 'tv') {
        if(currentPlayer === 1) p1Hirei += 10; else p2Hirei += 10;
        msg = "å…¨å›½æ”¾é€ã«å‡ºæ¼”ã€‚æ¯”ä¾‹ä»£è¡¨ã®æ”¯æŒç‡ãŒã‚¢ãƒƒãƒ—ã—ã¾ã—ãŸã€‚";
    } else if (type === 'scandal') {
        const list = Object.keys(status).filter(p => status[p] === opp);
        if(list.length) {
            const p = list[Math.floor(Math.random()*list.length)];
            status[p] = 0;
            msg = `ç›¸æ‰‹å€™è£œã«ä¸ç¥¥äº‹ï¼${p}ãŒç©ºç™½åŒºã«ãªã‚Šã¾ã—ãŸã€‚`;
        }
    } else if (type === 'home') {
        if(currentPlayer === 1) p1Hirei += 5; else p2Hirei += 5;
        msg = "åœ°å…ƒã‚’ä¸å¯§ã«å›ã‚Šã€æ”¯æŒåŸºç›¤ã‚’å›ºã‚ã¾ã—ãŸã€‚";
    } else if (type === 'last') {
        const list = Object.keys(status).filter(p => status[p] === 0);
        if(list.length) status[list[0]] = currentPlayer;
        if(currentPlayer === 1) p1Hirei += 5; else p2Hirei += 5;
        msg = "ç·æ±ºèµ·é›†ä¼šã‚’é–‹å‚¬ï¼æ°—å‹¢ã‚’ä¸Šã’ã¾ã—ãŸã€‚";
    }

    addLog(`${currentPlayer === 1 ? p1Name : p2Name}: ${msg}`);
    currentPlayer = opp;
    turns--;
    if(turns % 2 === 0) day++;
    updateUI();
    
    if(turns <= 0) finish();
}

function updateUI() {
    let s1 = 0, s2 = 0;
    Object.keys(status).forEach(p => {
        const d = document.getElementById(p);
        d.className = `pref ${status[p] === 1 ? 'p1' : (status[p] === 2 ? 'p2' : 'neutral')}`;
        if(status[p] === 1) s1 += SEATS[p];
        if(status[p] === 2) s2 += SEATS[p];
    });

    // è­°å¸­ãƒãƒ¼ã®æ›´æ–°
    const total = 465;
    document.getElementById("m1").style.width = (s1 / total * 100) + "%";
    document.getElementById("m2").style.width = (s2 / total * 100) + "%";
    
    document.getElementById("p1Stats").textContent = `${p1Name}: ${s1} è­°å¸­`;
    document.getElementById("p2Stats").textContent = `${p2Name}: ${s2} è­°å¸­`;
    document.getElementById("p1Prop").textContent = `1P: ${p1Hirei}ä¸‡ç¥¨`;
    document.getElementById("p2Prop").textContent = `2P: ${p2Hirei}ä¸‡ç¥¨`;
    document.getElementById("dispDay").textContent = `æ®‹ã‚Š ${turns} ã‚¿ãƒ¼ãƒ³`;

    const tBox = document.getElementById("turnBox");
    tBox.textContent = currentPlayer === 1 ? `${p1Name}ã®ç•ªã§ã™` : `${p2Name}ã®ç•ªã§ã™`;
    tBox.style.background = currentPlayer === 1 ? "var(--p1)" : "var(--p2)";
    tBox.style.color = currentPlayer === 1 ? "#000" : "#fff";
}

function finish() {
    let s1 = 0, s2 = 0;
    Object.keys(status).forEach(p => {
        if(status[p] === 1) s1 += SEATS[p];
        if(status[p] === 2) s2 += SEATS[p];
    });
    // æ¯”ä¾‹ä»£è¡¨ã®åŠ ç®—ï¼ˆç°¡æ˜“è¨ˆç®—ï¼‰
    s1 += Math.floor(p1Hirei / 2);
    s2 += Math.floor(p2Hirei / 2);

    const winner = s1 > s2 ? p1Name : p2Name;
    alert(`ã€æŠ•é–‹ç¥¨çµæœã€‘\n${p1Name}: ${s1} è­°å¸­\n${p2Name}: ${s2} è­°å¸­\n\nå‹åˆ©æ”¿å…šï¼š${winner}ï¼`);
    location.reload();
}

function addLog(m) {
    const l = document.getElementById("log");
    const d = document.createElement("div");
    d.textContent = "> " + m;
    l.prepend(d);
}
</script>
</body>
</html>
