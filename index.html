<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>è¡†é™¢é¸2026 å®Œå…¨ç‰ˆA+B</title>
<style>
:root{
--bg:#020617;--card:#1e293b;
--p1:#22c55e;--p2:#3b82f6;
}
body{margin:0;font-family:sans-serif;background:var(--bg);color:#fff}
.screen{display:none;padding:20px}
.screen.active{display:block}
.card{background:var(--card);padding:15px;border-radius:12px;margin-bottom:15px}
button{padding:10px;border-radius:8px;border:none;cursor:pointer;font-weight:bold}
button.act{width:100%;margin:4px 0;background:#334155;color:#fff}
button.act:hover{background:#475569}

.meter{position:relative;height:40px;background:#111827;border-radius:20px;overflow:hidden;border:2px solid #fff;margin-bottom:15px;display:flex}
.bar-left{background:var(--p1);height:100%;display:flex;align-items:center;padding-left:10px;font-weight:bold}
.bar-right{background:var(--p2);height:100%;margin-left:auto;display:flex;align-items:center;justify-content:flex-end;padding-right:10px;font-weight:bold}
.center-line{position:absolute;left:50%;top:0;width:3px;height:100%;background:#fff}

.game{display:grid;grid-template-columns:1fr 300px;gap:15px}
.region{margin-bottom:10px}
.region-title{color:#facc15;font-size:.8rem;border-bottom:1px solid #334155}
.pref-wrap{display:flex;flex-wrap:wrap;gap:6px;margin-top:6px}
.pref{padding:6px 8px;border-radius:6px;font-size:.7rem;background:#334155;cursor:pointer}
.pref.p1{background:var(--p1);color:#000;font-weight:bold}
.pref.p2{background:var(--p2);font-weight:bold}
.log{height:100px;overflow:auto;font-size:.8rem;background:#0f172a;padding:8px;border-radius:8px}
</style>
</head>
<body>

<div id="setup" class="screen active">
<div class="card">
<h2>ãƒ¢ãƒ¼ãƒ‰é¸æŠ</h2>
<label><input type="radio" name="mode" value="solo" checked> 1äººãƒ—ãƒ¬ã‚¤</label><br>
<label><input type="radio" name="mode" value="vs"> 2äººãƒ—ãƒ¬ã‚¤</label>
</div>
<div class="card">
<input id="p1name" placeholder="ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼1æ”¿å…šå">
<input id="p2name" placeholder="ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼2æ”¿å…šå">
</div>
<button onclick="start()">é–‹å§‹</button>
</div>

<div id="game" class="screen">
<div id="turnInfo"></div>

<div class="meter">
<div id="bar1" class="bar-left"></div>
<div id="bar2" class="bar-right"></div>
<div class="center-line"></div>
</div>

<div class="game">
<div id="map"></div>
<div>
<button class="act" onclick="speechMode()">ğŸ¤ æ¼”èª¬</button>
<button class="act" onclick="action('sns')">ğŸ“± SNS</button>
<button class="act" onclick="action('tv')">ğŸ“º TV</button>
<button class="act" onclick="action('scandal')">ğŸ”¥ ã‚¹ã‚­ãƒ£ãƒ³ãƒ€ãƒ«</button>
<div class="log" id="log"></div>
</div>
</div>
</div>

<div id="result" class="screen">
<h2>ğŸ“º é–‹ç¥¨é€Ÿå ±</h2>
<div class="meter">
<div id="rbar1" class="bar-left"></div>
<div id="rbar2" class="bar-right"></div>
<div class="center-line"></div>
</div>
<div id="countText"></div>
<div id="winner" style="font-size:24px;margin-top:20px"></div>
<button onclick="location.reload()">ã‚‚ã†ä¸€åº¦</button>
</div>

<script>
const PREFS=["åŒ—æµ·é“","é’æ£®","å²©æ‰‹","å®®åŸ","ç§‹ç”°","å±±å½¢","ç¦å³¶",
"èŒ¨åŸ","æ ƒæœ¨","ç¾¤é¦¬","åŸ¼ç‰","åƒè‘‰","æ±äº¬","ç¥å¥ˆå·",
"æ–°æ½Ÿ","å¯Œå±±","çŸ³å·","ç¦äº•","å±±æ¢¨","é•·é‡","å²é˜œ","é™å²¡","æ„›çŸ¥",
"ä¸‰é‡","æ»‹è³€","äº¬éƒ½","å¤§é˜ª","å…µåº«","å¥ˆè‰¯","å’Œæ­Œå±±",
"é³¥å–","å³¶æ ¹","å²¡å±±","åºƒå³¶","å±±å£","å¾³å³¶","é¦™å·","æ„›åª›","é«˜çŸ¥",
"ç¦å²¡","ä½è³€","é•·å´","ç†Šæœ¬","å¤§åˆ†","å®®å´","é¹¿å…å³¶","æ²–ç¸„"];

const TOTAL=465;
const PR=176;
const SMD=289;

let data={},mode,current=1,turn=1;
let p1,p2;
let speech=false;

function start(){
mode=document.querySelector("input[name=mode]:checked").value;
p1=document.getElementById("p1name").value||"ç·‘å…š";
p2=mode==="solo"?"AIå…š":(document.getElementById("p2name").value||"é’å…š");

document.getElementById("setup").classList.remove("active");
document.getElementById("game").classList.add("active");

const map=document.getElementById("map");
PREFS.forEach(p=>{
data[p]={p1:50+Math.random()*20-10,p2:50+Math.random()*20-10};
const d=document.createElement("div");
d.className="pref";
d.textContent=p;
d.onclick=()=>prefClick(p);
map.appendChild(d);
});
update();
}

function log(t){
document.getElementById("log").innerHTML=t+"<br>"+document.getElementById("log").innerHTML;
}

function speechMode(){speech=true;}

function prefClick(p){
if(!speech)return;
data[p]["p"+current]+=8;
log(p+"ã§æ¼”èª¬ï¼");
speech=false;
next();
}

function action(type){
if(type==="sns") globalEffect(3);
if(type==="tv") globalEffect(5);
if(type==="scandal") scandal();
next();
}

function globalEffect(val){
PREFS.forEach(p=>data[p]["p"+current]+=val);
log("å…¨å›½æ”¯æŒç‡ä¸Šæ˜‡");
}

function scandal(){
PREFS.forEach(p=>data[p]["p"+(current===1?2:1)]-=5);
log("ç›¸æ‰‹ã«æ‰“æ’ƒï¼");
}

function next(){
if(mode==="solo" && current===1){aiTurn();}
current=current===1?2:1;
turn++;
update();
if(turn>40) finish();
}

function aiTurn(){
let r=PREFS[Math.floor(Math.random()*PREFS.length)];
data[r].p2+=8;
}

function calculate(){
let smd1=0,smd2=0;
PREFS.forEach(p=>{
if(data[p].p1>data[p].p2)smd1++;
else smd2++;
});
let totalP1=0,totalP2=0;
PREFS.forEach(p=>{totalP1+=data[p].p1;totalP2+=data[p].p2});
let pr1=Math.round(PR*(totalP1/(totalP1+totalP2)));
let pr2=PR-pr1;
return{smd1,smd2,pr1,pr2,total1:smd1+pr1,total2:smd2+pr2};
}

function update(){
const c=calculate();
document.getElementById("turnInfo").textContent=
"ã‚¿ãƒ¼ãƒ³ï¼š"+turn+"ï½œç¾åœ¨ï¼š"+(current===1?p1:p2);

document.querySelectorAll(".pref").forEach(e=>{
let p=e.textContent;
e.className="pref "+(data[p].p1>data[p].p2?"p1":"p2");
});

document.getElementById("bar1").style.width=(c.total1/TOTAL*100)+"%";
document.getElementById("bar2").style.width=(c.total2/TOTAL*100)+"%";
document.getElementById("bar1").textContent=p1+" "+c.total1;
document.getElementById("bar2").textContent=c.total2+" "+p2;
}

function finish(){
document.getElementById("game").classList.remove("active");
document.getElementById("result").classList.add("active");
counting();
}

function counting(){
const final=calculate();
let c1=0,c2=0;
let seats=[...Array(final.total1).fill(1),...Array(final.total2).fill(2)];
seats.sort(()=>Math.random()-0.5);
let i=0;
let interval=setInterval(()=>{
if(i<seats.length){
if(seats[i]===1)c1++;else c2++;
i++;
updateBar(c1,c2);
}else{
clearInterval(interval);
document.getElementById("winner").textContent=
c1>c2?"ğŸ‰ "+p1+" å‹åˆ©ï¼":"ğŸ‰ "+p2+" å‹åˆ©ï¼";
}
},40);
}

function updateBar(a,b){
document.getElementById("rbar1").style.width=(a/TOTAL*100)+"%";
document.getElementById("rbar2").style.width=(b/TOTAL*100)+"%";
document.getElementById("rbar1").textContent=p1+" "+a;
document.getElementById("rbar2").textContent=b+" "+p2;
document.getElementById("countText").textContent=
(a+b)+" / "+TOTAL+" é–‹ç¥¨";
}
</script>
</body>
</html>
