<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>è¡†é™¢é¸2026 å®Œå…¨é€²åŒ–ç‰ˆ</title>
<style>
body{margin:0;font-family:sans-serif;background:#0f172a;color:#fff}
.screen{display:none;padding:20px}
.screen.active{display:block}
.card{background:#1e293b;padding:15px;border-radius:10px;margin-bottom:15px}
button{padding:8px 12px;border:none;border-radius:6px;cursor:pointer}
.map{display:flex;flex-wrap:wrap;gap:6px}
.pref{width:70px;height:30px;font-size:.7rem;
display:flex;align-items:center;justify-content:center;
border-radius:4px;cursor:pointer}
.result-box{font-size:1.2rem;margin-top:15px}
</style>
</head>
<body>

<!-- æº–å‚™ -->
<div id="setup" class="screen active">
<h2>è¡†é™¢é¸2026</h2>

<div class="card">
<input id="partyName" placeholder="ã‚ãªãŸã®æ”¿å…šå">
</div>

<div class="card">
<p>å…¬ç´„ã‚’5ã¤é¸æŠ</p>
<label><input type="checkbox" value="çµŒæ¸ˆ">çµŒæ¸ˆæˆé•·</label>
<label><input type="checkbox" value="è¾²æ¥­">è¾²æ¥­</label>
<label><input type="checkbox" value="æ•™è‚²">æ•™è‚²</label>
<label><input type="checkbox" value="é˜²è¡›">é˜²è¡›</label>
<label><input type="checkbox" value="ç¤¾ä¼šä¿éšœ">ç¤¾ä¼šä¿éšœ</label>
<label><input type="checkbox" value="éƒ½å¸‚æ”¿ç­–">éƒ½å¸‚æ”¿ç­–</label>
<label><input type="checkbox" value="åœ°æ–¹å‰µç”Ÿ">åœ°æ–¹å‰µç”Ÿ</label>
</div>

<button onclick="start()">é–‹å§‹</button>
</div>

<!-- ã‚²ãƒ¼ãƒ  -->
<div id="game" class="screen">
<h3 id="day"></h3>

<div>
<button onclick="speechMode()">ğŸ¤è¡—é ­æ¼”èª¬</button>
<button onclick="sns()">ğŸ“±SNS</button>
<button onclick="tv()">ğŸ“ºå…¨å›½æ”¾é€</button>
<button onclick="scandal()">ğŸ”¥ã‚¹ã‚­ãƒ£ãƒ³ãƒ€ãƒ«</button>
</div>

<div class="map" id="map"></div>
</div>

<!-- çµæœ -->
<div id="result" class="screen">
<h2>é¸æŒ™çµæœ</h2>
<div id="final"></div>
<button onclick="location.reload()">ã‚‚ã†ä¸€åº¦</button>
</div>

<script>
const PREFS=["åŒ—æµ·é“","é’æ£®","å²©æ‰‹","å®®åŸ","ç§‹ç”°","å±±å½¢","ç¦å³¶",
"èŒ¨åŸ","æ ƒæœ¨","ç¾¤é¦¬","åŸ¼ç‰","åƒè‘‰","æ±äº¬","ç¥å¥ˆå·",
"æ–°æ½Ÿ","å¯Œå±±","çŸ³å·","ç¦äº•","å±±æ¢¨","é•·é‡","å²é˜œ","é™å²¡","æ„›çŸ¥",
"ä¸‰é‡","æ»‹è³€","äº¬éƒ½","å¤§é˜ª","å…µåº«","å¥ˆè‰¯","å’Œæ­Œå±±",
"é³¥å–","å³¶æ ¹","å²¡å±±","åºƒå³¶","å±±å£","å¾³å³¶","é¦™å·","æ„›åª›","é«˜çŸ¥",
"ç¦å²¡","ä½è³€","é•·å´","ç†Šæœ¬","å¤§åˆ†","å®®å´","é¹¿å…å³¶","æ²–ç¸„"];

const TOTAL=465, DISTRICT=289, PR=176;

let support={},aiSupport={};
let turn=1;
let party="ã‚ãªãŸå…š";
let ai="AIå…š";
let policies=[];
let speechSelect=false;

function start(){
const checks=[...document.querySelectorAll("input:checked")];
if(checks.length!==5){alert("5ã¤é¸æŠã—ã¦ãã ã•ã„");return;}
policies=checks.map(c=>c.value);
party=document.getElementById("partyName").value||"ã‚ãªãŸå…š";

document.getElementById("setup").classList.remove("active");
document.getElementById("game").classList.add("active");

PREFS.forEach(p=>{
support[p]=50;
aiSupport[p]=50;
const d=document.createElement("div");
d.className="pref";
d.id=p;
d.onclick=()=>selectPref(p);
document.getElementById("map").appendChild(d);
});

update();
}

function speechMode(){
speechSelect=true;
alert("æ¼”èª¬ã™ã‚‹çœŒã‚’ã‚¯ãƒªãƒƒã‚¯");
}

function selectPref(p){
if(!speechSelect)return;
support[p]+=5;
if(policies.includes("è¾²æ¥­")||policies.includes("åœ°æ–¹å‰µç”Ÿ"))
support[p]+=3;
speechSelect=false;
nextTurn();
}

function sns(){
["æ±äº¬","å¤§é˜ª","ç¥å¥ˆå·","æ„›çŸ¥","åŸ¼ç‰","åƒè‘‰"]
.forEach(p=>support[p]+=4);
if(policies.includes("éƒ½å¸‚æ”¿ç­–")) 
["æ±äº¬","å¤§é˜ª"].forEach(p=>support[p]+=3);
nextTurn();
}

function tv(){
PREFS.forEach(p=>support[p]+=2);
nextTurn();
}

function scandal(){
const target=PREFS[Math.floor(Math.random()*PREFS.length)];
aiSupport[target]-=6;
nextTurn();
}

function aiTurn(){
PREFS.forEach(p=>aiSupport[p]+=Math.random()*3);
}

function nextTurn(){
aiTurn();
turn++;
update();
if(turn>45)finish();
}

function update(){
document.getElementById("day").textContent=
Math.ceil(turn/3)+"æ—¥ç›® "+["æœ","æ˜¼","å¤œ"][(turn-1)%3];

PREFS.forEach(p=>{
const el=document.getElementById(p);
const diff=support[p]-aiSupport[p];
if(diff>10) el.style.background="#22c55e";
else if(diff<-10) el.style.background="#3b82f6";
else el.style.background="#64748b";
});
}

function finish(){
document.getElementById("game").classList.remove("active");
document.getElementById("result").classList.add("active");

let district1=0,district2=0;
PREFS.forEach(p=>{
if(support[p]>aiSupport[p]) district1++;
else district2++;
});

district1=Math.round(district1*(DISTRICT/47));
district2=DISTRICT-district1;

let totalSupport1=0,totalSupport2=0;
PREFS.forEach(p=>{
totalSupport1+=support[p];
totalSupport2+=aiSupport[p];
});

let pr1=Math.round(PR*(totalSupport1/(totalSupport1+totalSupport2)));
let pr2=PR-pr1;

let total1=district1+pr1;
let total2=district2+pr2;

document.getElementById("final").innerHTML=
`${party}: ${total1}è­°å¸­<br>
${ai}: ${total2}è­°å¸­<br>
éåŠæ•°: 233è­°å¸­<br>
å‹è€…: ${total1>total2?party:ai}`;
}
</script>
</body>
</html>
