<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>è¡†é™¢é¸2026 å®Œå…¨ãƒªã‚¢ãƒ«ç‰ˆ</title>
<style>
:root{
--bg:#020617;--card:#1e293b;
--p1:#22c55e;--p2:#3b82f6;
}
body{margin:0;font-family:sans-serif;background:var(--bg);color:#fff}
.screen{display:none;padding:20px}
.screen.active{display:block}
.card{background:var(--card);padding:15px;border-radius:12px;margin-bottom:15px}
button{padding:10px;border-radius:8px;border:none;cursor:pointer;font-weight:bold}
button.act{width:100%;margin:4px 0;background:#334155;color:#fff}
button.act:hover{background:#475569}

.meter{position:relative;height:40px;background:#111827;border-radius:20px;overflow:hidden;border:2px solid #fff;margin-bottom:10px;display:flex}
.bar-left{background:var(--p1);height:100%;display:flex;align-items:center;padding-left:10px;font-weight:bold}
.bar-right{background:var(--p2);height:100%;margin-left:auto;display:flex;align-items:center;justify-content:flex-end;padding-right:10px;font-weight:bold}
.center-line{position:absolute;left:50%;top:0;width:3px;height:100%;background:#fff}

.game{display:grid;grid-template-columns:1fr 300px;gap:15px}

#map{
display:grid;
grid-template-columns:repeat(auto-fill,minmax(90px,1fr));
gap:6px;
}
.pref{
padding:8px;
border-radius:6px;
font-size:.75rem;
text-align:center;
background:#334155;
cursor:pointer
}
.pref.p1{background:var(--p1);color:#000;font-weight:bold}
.pref.p2{background:var(--p2);font-weight:bold}

.log{height:120px;overflow:auto;font-size:.8rem;background:#0f172a;padding:8px;border-radius:8px}
.small{font-size:.8rem;color:#cbd5e1}
</style>
</head>
<body>

<div id="setup" class="screen active">
<div class="card">
<h2>ãƒ¢ãƒ¼ãƒ‰é¸æŠ</h2>
<label><input type="radio" name="mode" value="solo" checked> 1äººãƒ—ãƒ¬ã‚¤</label><br>
<label><input type="radio" name="mode" value="vs"> 2äººãƒ—ãƒ¬ã‚¤</label>
</div>
<div class="card">
<input id="p1name" placeholder="ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼1æ”¿å…šå">
<input id="p2name" placeholder="ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼2æ”¿å…šå">
</div>
<button onclick="start()">é–‹å§‹</button>
</div>

<div id="game" class="screen">
<div id="turnInfo" style="font-weight:bold;margin-bottom:10px"></div>

<div class="meter">
<div id="bar1" class="bar-left"></div>
<div id="bar2" class="bar-right"></div>
<div class="center-line"></div>
</div>
<div id="seatDetail" class="small"></div>

<div class="game">
<div id="map"></div>
<div>
<button class="act" onclick="speechMode()">ğŸ¤ æ¼”èª¬</button>
<button class="act" onclick="action('sns')">ğŸ“± SNS</button>
<button class="act" onclick="action('tv')">ğŸ“º TV</button>
<button class="act" onclick="action('scandal')">ğŸ”¥ ã‚¹ã‚­ãƒ£ãƒ³ãƒ€ãƒ«</button>
<div class="log" id="log"></div>
</div>
</div>
</div>

<div id="result" class="screen">
<h2>ğŸ“º é–‹ç¥¨é€Ÿå ±</h2>
<div class="meter">
<div id="rbar1" class="bar-left"></div>
<div id="rbar2" class="bar-right"></div>
<div class="center-line"></div>
</div>
<div id="countText"></div>
<div id="winner" style="font-size:24px;margin-top:20px"></div>
<button onclick="location.reload()">ã‚‚ã†ä¸€åº¦</button>
</div>

<script>
const TOTAL=465;
const PR=176;
const SMD=289;
const DAYS=15;
const PHASES=["æœ","æ˜¼","å¤œ"];

const SEATS={
"åŒ—æµ·é“":12,"é’æ£®":3,"å²©æ‰‹":3,"å®®åŸ":6,"ç§‹ç”°":3,"å±±å½¢":3,"ç¦å³¶":5,
"èŒ¨åŸ":7,"æ ƒæœ¨":4,"ç¾¤é¦¬":4,"åŸ¼ç‰":15,"åƒè‘‰":13,"æ±äº¬":30,"ç¥å¥ˆå·":18,
"æ–°æ½Ÿ":6,"å¯Œå±±":3,"çŸ³å·":3,"ç¦äº•":2,"å±±æ¢¨":2,"é•·é‡":5,"å²é˜œ":5,"é™å²¡":8,"æ„›çŸ¥":15,
"ä¸‰é‡":4,"æ»‹è³€":4,"äº¬éƒ½":6,"å¤§é˜ª":19,"å…µåº«":12,"å¥ˆè‰¯":3,"å’Œæ­Œå±±":2,
"é³¥å–":2,"å³¶æ ¹":2,"å²¡å±±":5,"åºƒå³¶":7,"å±±å£":4,"å¾³å³¶":2,"é¦™å·":3,"æ„›åª›":4,"é«˜çŸ¥":2,
"ç¦å²¡":11,"ä½è³€":2,"é•·å´":4,"ç†Šæœ¬":4,"å¤§åˆ†":3,"å®®å´":3,"é¹¿å…å³¶":4,"æ²–ç¸„":4
};

const PREFS=Object.keys(SEATS);

let data={},mode,current=1,turn=1;
let p1,p2;
let speech=false;

function start(){
mode=document.querySelector("input[name=mode]:checked").value;
p1=document.getElementById("p1name").value||"ç·‘å…š";
p2=mode==="solo"?"AIå…š":(document.getElementById("p2name").value||"é’å…š");

document.getElementById("setup").classList.remove("active");
document.getElementById("game").classList.add("active");

const map=document.getElementById("map");
PREFS.forEach(p=>{
data[p]={p1:50+Math.random()*10-5,p2:50+Math.random()*10-5};
const d=document.createElement("div");
d.className="pref";
d.textContent=p+"("+SEATS[p]+")";
d.onclick=()=>prefClick(p);
map.appendChild(d);
});
update();
}

function speechMode(){speech=true;}

function prefClick(p){
if(!speech)return;
data[p]["p"+current]+=8;
speech=false;
next();
}

function action(type){
if(type==="sns") globalEffect(2);
if(type==="tv") globalEffect(4);
if(type==="scandal") scandal();
next();
}

function globalEffect(val){
PREFS.forEach(p=>data[p]["p"+current]+=val);
}

function scandal(){
PREFS.forEach(p=>data[p]["p"+(current===1?2:1)]-=4);
}

function next(){
if(mode==="solo" && current===1){aiTurn();}
current=current===1?2:1;
turn++;
update();
if(turn>DAYS*3) finish();
}

function aiTurn(){
let r=PREFS[Math.floor(Math.random()*PREFS.length)];
data[r].p2+=8;
}

function calculate(){
let smd1=0,smd2=0;

PREFS.forEach(p=>{
if(data[p].p1>data[p].p2)
   smd1+=SEATS[p];
else
   smd2+=SEATS[p];
});

let totalP1=0,totalP2=0;
PREFS.forEach(p=>{
totalP1+=data[p].p1;
totalP2+=data[p].p2;
});

let pr1=Math.round(PR*(totalP1/(totalP1+totalP2)));
let pr2=PR-pr1;

return{
smd1,smd2,
pr1,pr2,
total1:smd1+pr1,
total2:smd2+pr2
};
}

function update(){
const c=calculate();

let day=Math.ceil(turn/3);
let phase=PHASES[(turn-1)%3];

document.getElementById("turnInfo").textContent=
day+"æ—¥ç›®ã€"+phase+"ã€‘ï½œç¾åœ¨ï¼š"+(current===1?p1:p2);

document.querySelectorAll(".pref").forEach(e=>{
let p=e.textContent.split("(")[0];
e.className="pref "+(data[p].p1>data[p].p2?"p1":"p2");
});

document.getElementById("bar1").style.width=(c.total1/TOTAL*100)+"%";
document.getElementById("bar2").style.width=(c.total2/TOTAL*100)+"%";
document.getElementById("bar1").textContent=p1+" "+c.total1;
document.getElementById("bar2").textContent=c.total2+" "+p2;

document.getElementById("seatDetail").textContent=
"å°é¸æŒ™åŒºï¼š"+c.smd1+" / "+c.smd2+
" ï½œ æ¯”ä¾‹ï¼š"+c.pr1+" / "+c.pr2+
" ï½œ åˆè¨ˆï¼š"+c.total1+" / "+c.total2+"ï¼ˆ465ï¼‰";
}

function finish(){
document.getElementById("game").classList.remove("active");
document.getElementById("result").classList.add("active");
counting();
}

function counting(){
const final=calculate();

let smdSeats=[];
for(let i=0;i<final.smd1;i++)smdSeats.push(1);
for(let i=0;i<final.smd2;i++)smdSeats.push(2);
smdSeats.sort(()=>Math.random()-0.5);

let prSeats=[];
for(let i=0;i<final.pr1;i++)prSeats.push(1);
for(let i=0;i<final.pr2;i++)prSeats.push(2);

let allSeats=[...smdSeats,...prSeats];

let c1=0,c2=0,i=0;

let interval=setInterval(()=>{
if(i<allSeats.length){
if(allSeats[i]===1)c1++;else c2++;
i++;
updateBar(c1,c2);
}else{
clearInterval(interval);
document.getElementById("winner").textContent=
c1>c2?"ğŸ‰ "+p1+" å‹åˆ©ï¼":"ğŸ‰ "+p2+" å‹åˆ©ï¼";
}
},35);
}

function updateBar(a,b){
document.getElementById("rbar1").style.width=(a/TOTAL*100)+"%";
document.getElementById("rbar2").style.width=(b/TOTAL*100)+"%";
document.getElementById("rbar1").textContent=p1+" "+a;
document.getElementById("rbar2").textContent=b+" "+p2;
document.getElementById("countText").textContent=
(a+b)+" / "+TOTAL+" è­°å¸­ é–‹ç¥¨";
}
</script>
</body>
</html>
