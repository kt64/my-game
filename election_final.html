<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>é¸æŒ™ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</title>
<style>
body {
  font-family: sans-serif;
  background: #f4f6f8;
  margin: 0;
  padding: 0;
}

header {
  background: #1e3a8a;
  color: white;
  padding: 10px;
  text-align: center;
}

#status {
  padding: 10px;
  background: white;
  display: flex;
  justify-content: space-around;
}

#actions button {
  margin: 5px;
  padding: 10px;
  font-size: 14px;
}

#log {
  background: #fff;
  margin: 10px;
  padding: 10px;
  height: 160px;
  overflow-y: auto;
  border: 1px solid #ccc;
}

#map {
  margin: 10px;
  background: white;
  border: 1px solid #ccc;
}
</style>
</head>

<body>

<header>
<h1>è¡†è­°é™¢é¸æŒ™ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h1>
</header>

<div id="status">
  <div>ã‚¿ãƒ¼ãƒ³: <span id="turn">1</span>/20</div>
  <div>æ”¯æŒç‡: <span id="support">30</span>%</div>
  <div>è­°å¸­: <span id="seats">0</span>/465</div>
</div>

<div id="actions">
  <button onclick="actionSpeech()">è¡—é ­æ¼”èª¬</button>
  <button onclick="actionSNS()">SNSç™ºä¿¡</button>
  <button onclick="actionSurvey()">æƒ…å‹¢èª¿æŸ»</button>
  <button onclick="actionScandal()">ä¸ç¥¥äº‹å¯¾å¿œ</button>
  <button onclick="actionPolicy()">æ”¿ç­–ç™ºè¡¨</button>
</div>

<div id="log"></div>

<div id="map">
<svg viewBox="0 0 300 150" width="100%" height="200">
  <rect x="10" y="10" width="80" height="50" fill="#e5e7eb" stroke="#000"/>
  <rect x="110" y="10" width="80" height="50" fill="#e5e7eb" stroke="#000"/>
  <rect x="210" y="10" width="80" height="50" fill="#e5e7eb" stroke="#000"/>
  <rect x="60" y="80" width="80" height="50" fill="#e5e7eb" stroke="#000"/>
  <rect x="160" y="80" width="80" height="50" fill="#e5e7eb" stroke="#000"/>
</svg>
</div>

<script>
let turn = 1;
let support = 30;
let seats = 0;
let scandal = false;

function log(msg) {
  const logDiv = document.getElementById("log");
  logDiv.innerHTML += msg + "<br>";
  logDiv.scrollTop = logDiv.scrollHeight;
}

function nextTurn() {
  turn++;
  document.getElementById("turn").textContent = turn;

  // ä¸ç¥¥äº‹ãƒ©ãƒ³ãƒ€ãƒ ç™ºç”Ÿ
  if (Math.random() < 0.15) {
    scandal = true;
    log("âš ï¸ ä¸ç¥¥äº‹ãŒç™ºè¦šã—ã¾ã—ãŸï¼");
    support -= 3;
  }

  // çµ‚ç›¤ãƒ‹ãƒ¥ãƒ¼ã‚¹
  if (turn >= 16) {
    log("ğŸ“° çµ‚ç›¤æƒ…å‹¢ãƒ‹ãƒ¥ãƒ¼ã‚¹ï¼šæ”¯æŒç‡ãŒè­°å¸­ã«ç›´çµã—å§‹ã‚ã¦ã„ã¾ã™");
  }

  calculateSeats();
}

function calculateSeats() {
  const districtSeats = Math.floor(289 * (support / 100));
  const prSeats = Math.floor(176 * (support / 100));
  seats = Math.min(465, districtSeats + prSeats);
  document.getElementById("seats").textContent = seats;
}

function updateSupport(val) {
  support = Math.max(0, Math.min(100, support + val));
  document.getElementById("support").textContent = support;
}

function actionSpeech() {
  log("ğŸ“£ è¡—é ­æ¼”èª¬ã‚’è¡Œã£ãŸ");
  updateSupport(2);
  nextTurn();
}

function actionSNS() {
  log("ğŸ“± SNSã§ç™ºä¿¡ã—ãŸ");
  updateSupport(1);
  nextTurn();
}

function actionSurvey() {
  log(`ğŸ“Š æƒ…å‹¢èª¿æŸ»ï¼šç¾åœ¨ã®æ”¯æŒç‡ã¯ ${support}%`);
  nextTurn();
}

function actionScandal() {
  if (scandal) {
    log("ğŸ§¯ ä¸ç¥¥äº‹å¯¾å¿œã‚’è¡Œã£ãŸ");
    scandal = false;
    updateSupport(2);
  } else {
    log("ç‰¹ã«å¯¾å¿œã™ã¹ãä¸ç¥¥äº‹ã¯ã‚ã‚Šã¾ã›ã‚“");
  }
  nextTurn();
}

function actionPolicy() {
  log("ğŸ“œ æ–°æ”¿ç­–ã‚’ç™ºè¡¨ã—ãŸ");
  updateSupport(3);
  nextTurn();
}
</script>

</body>
</html>

