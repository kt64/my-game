<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>衆院選シミュレーター2026</title>
<style>
body{
  margin:0;
  font-family:"Hiragino Sans","Meiryo",sans-serif;
  background:#020617;
  color:#f8fafc;
}
button{
  padding:10px 14px;
  border:none;
  border-radius:8px;
  background:#facc15;
  font-weight:bold;
  cursor:pointer;
}
input{padding:8px;width:100%}

.screen{display:none;padding:30px}
.screen.active{display:block}

.card{
  background:#0f172a;
  padding:20px;
  border-radius:12px;
  margin-bottom:20px;
}

.layout{display:flex;gap:20px}

/* 地図 */
.map{
  position:relative;
  width:1100px;
  height:650px;
  background:#020617;
}
.pref{
  position:absolute;
  width:70px;
  height:40px;
  border-radius:8px;
  border:2px solid #fff;
  text-align:center;
  font-size:.75rem;
  line-height:40px;
  cursor:pointer;
}
.neutral{background:#334155}
.you{background:#f59e0b;color:#000}
.ai{background:#2563eb}

.side{width:320px}
.news{font-size:.85rem}
.bar{
  height:14px;
  background:#334155;
  border-radius:8px;
  overflow:hidden;
}
.bar-inner{
  height:100%;
  background:#22c55e;
}
</style>
</head>
<body>

<!-- 準備画面（ここだけ） -->
<div id="setup" class="screen active">
  <h1>衆院選シミュレーター2026</h1>

  <div class="card">
    <label>あなたの政党名</label>
    <input id="partyName" placeholder="例：未来日本党">
  </div>

  <div class="card">
    <p>公約を5つ選んでください</p>
    <label><input type="checkbox"> 社会保障</label><br>
    <label><input type="checkbox"> 経済成長</label><br>
    <label><input type="checkbox"> 教育</label><br>
    <label><input type="checkbox"> 防衛</label><br>
    <label><input type="checkbox"> エネルギー</label><br>
    <label><input type="checkbox"> 農業</label><br>
    <label><input type="checkbox"> 政治とカネ</label><br>
    <label><input type="checkbox"> 外国人政策</label>
  </div>

  <button onclick="startGame()">ゲーム開始</button>
</div>

<!-- ゲーム画面（開始後のみ） -->
<div id="game" class="screen">
  <h2 id="title"></h2>

  <div class="layout">
    <div class="map" id="map"></div>

    <div class="side">
      <h3>行動</h3>
      <button onclick="action()">行動する</button>

      <h3>支持率</h3>
      <div class="bar"><div id="trendBar" class="bar-inner"></div></div>

      <h3>ニュース</h3>
      <div id="news" class="news"></div>

      <h3>議席</h3>
      <div id="seats"></div>
    </div>
  </div>
</div>

<script>
const TOTAL_SEATS = 465;

/* 47都道府県（簡略配置） */
const PREFS = [
"北海道","青森","岩手","宮城","秋田","山形","福島",
"茨城","栃木","群馬","埼玉","千葉","東京","神奈川",
"新潟","富山","石川","福井","山梨","長野",
"岐阜","静岡","愛知","三重",
"滋賀","京都","大阪","兵庫","奈良","和歌山",
"鳥取","島根","岡山","広島","山口",
"徳島","香川","愛媛","高知",
"福岡","佐賀","長崎","熊本","大分","宮崎","鹿児島","沖縄"
];

let status={},support=50,partyName="";

function startGame(){
  partyName=document.getElementById("partyName").value||"あなた党";
  document.getElementById("setup").classList.remove("active");
  document.getElementById("game").classList.add("active");
  document.getElementById("title").textContent=partyName+" 選挙戦";
  drawMap();
  update();
}

function drawMap(){
  const map=document.getElementById("map");
  map.innerHTML="";
  PREFS.forEach((p,i)=>{
    status[p]="neutral";
    const d=document.createElement("div");
    d.className="pref neutral";
    d.textContent=p;
    d.style.left=(i%10)*100+"px";
    d.style.top=Math.floor(i/10)*60+"px";
    d.onclick=()=>{status[p]="you";update()};
    map.appendChild(d);
  });
}

function action(){
  support+=Math.floor(Math.random()*5)-2;
  log("選挙活動を実施");
  update();
}

function update(){
  const you=Math.round(TOTAL_SEATS*(support/100));
  const ai=TOTAL_SEATS-you;
  document.getElementById("seats").textContent=
    `${partyName}: ${you} / 相手党: ${ai}`;
  document.getElementById("trendBar").style.width=
    Math.max(0,Math.min(100,support))+"%";

  Object.keys(status).forEach(p=>{
    const el=[...document.querySelectorAll(".pref")].find(e=>e.textContent===p);
    el.className="pref "+status[p];
  });
}

function log(msg){
  const n=document.getElementById("news");
  n.innerHTML="<div>"+msg+"</div>"+n.innerHTML;
}
</script>
</body>
</html>
